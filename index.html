<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cus Box - Giải Đấu</title>
    <!-- Google Fonts for impactful text -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Anton&family=Roboto:wght@700&display=swap" rel="stylesheet">
    <!-- Thư viện để xuất ảnh -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* --- Cài Đặt Biến Màu & Chủ Đề --- */
        :root {
            /* Theme Mặc định (Free Fire) */
            --bg-image: url('./img//back\ 1.jpg');
            --primary-color: #ffd700;
            --container-bg: rgba(0, 0, 0, 0.75);
            --container-border: #ffd700;
            --title-glow: #ffd700;
            --image-glow: #ffd700;
        }

        body.theme-ocean {
            --bg-image: url('https://images.unsplash.com/photo-1439405326854-014607f694d7?q=80&w=2070&auto=format&fit=crop');
            --primary-color: #00e5ff;
            --container-bg: rgba(0, 25, 50, 0.8);
            --container-border: #00e5ff;
            --title-glow: #00e5ff;
            --image-glow: #00e5ff;
        }

        body.theme-volcano {
             --bg-image: url('https://images.unsplash.com/photo-1619266379927-3174029b5379?q=80&w=1974&auto=format&fit=crop');
             --primary-color: #ff4500;
             --container-bg: rgba(30, 0, 0, 0.8);
             --container-border: #ff4500;
             --title-glow: #ffae00;
             --image-glow: #ff4500;
        }
        
        body.theme-action {
            --bg-image: url('https://images.unsplash.com/photo-1588341221532-62584d9f3458?q=80&w=1964&auto=format&fit=crop');
            --primary-color: #00ff7f;
            --container-bg: rgba(10, 10, 10, 0.85);
            --container-border: #00ff7f;
            --title-glow: #00ff7f;
            --image-glow: #00ff7f;
        }
        
        body.theme-cyberpunk {
            --bg-image: url('https://images.unsplash.com/photo-1531297484001-80022131f5a1?q=80&w=2020&auto=format&fit=crop');
            --primary-color: #ff00ff;
            --container-bg: rgba(25, 0, 50, 0.85);
            --container-border: #ff00ff;
            --title-glow: #00e5ff;
            --image-glow: #ff00ff;
        }

        body.theme-jungle {
            --bg-image: url('https://images.unsplash.com/photo-1501854140801-50d01698950b?q=80&w=1950&auto=format&fit=crop');
            --primary-color: #228B22;
            --container-bg: rgba(0, 30, 10, 0.85);
            --container-border: #228B22;
            --title-glow: #9ACD32;
            --image-glow: #228B22;
        }
        
        body.theme-galaxy {
            --bg-image: url('https://images.unsplash.com/photo-1534796636912-3b95b3ab5986?q=80&w=2071&auto=format&fit=crop');
            --primary-color: #9370DB;
            --container-bg: rgba(10, 0, 20, 0.85);
            --container-border: #9370DB;
            --title-glow: #E6E6FA;
            --image-glow: #9370DB;
        }
        
        body.theme-desert {
            --bg-image: url('https://images.unsplash.com/photo-1473580044384-7ba9967e16a0?q=80&w=2070&auto=format&fit=crop');
            --primary-color: #FFA500;
            --container-bg: rgba(50, 25, 0, 0.8);
            --container-border: #FFA500;
            --title-glow: #FFD700;
            --image-glow: #FFA500;
        }

        body.theme-arctic {
            --bg-image: url('https://images.unsplash.com/photo-1549472539-b2767b365851?q=80&w=1961&auto=format&fit=crop');
            --primary-color: #ADD8E6;
            --container-bg: rgba(20, 30, 50, 0.8);
            --container-border: #ADD8E6;
            --title-glow: #FFFFFF;
            --image-glow: #ADD8E6;
        }

        body.theme-sakura {
            --bg-image: url('https://images.unsplash.com/photo-1522383225653-ed111181a951?q=80&w=1974&auto=format&fit=crop');
            --primary-color: #FFC0CB;
            --container-bg: rgba(50, 20, 30, 0.85);
            --container-border: #FFC0CB;
            --title-glow: #FFFFFF;
            --image-glow: #FFC0CB;
        }

        body.theme-urban {
            --bg-image: url('https://images.unsplash.com/photo-1524231757912-21f4fe3a7207?q=80&w=1974&auto=format&fit=crop');
            --primary-color: #808080;
            --container-bg: rgba(20, 20, 20, 0.85);
            --container-border: #A9A9A9;
            --title-glow: #FFFFFF;
            --image-glow: #A9A9A9;
        }

        body.theme-synthwave {
            --bg-image: url('https://images.unsplash.com/photo-1520045892732-304bc3ac5d8e?q=80&w=2070&auto=format&fit=crop');
            --primary-color: #ff00c1;
            --container-bg: rgba(20, 0, 30, 0.85);
            --container-border: #ff00c1;
            --title-glow: #00d9ff;
            --image-glow: #ff00c1;
        }

        body.theme-apocalyptic {
            --bg-image: url('https://images.unsplash.com/photo-1617789505258-2cfe831308a3?q=80&w=1974&auto=format&fit=crop');
            --primary-color: #8B4513;
            --container-bg: rgba(40, 30, 20, 0.85);
            --container-border: #8B4513;
            --title-glow: #D2B48C;
            --image-glow: #8B4513;
        }

        body.theme-fantasy {
            --bg-image: url('https://images.unsplash.com/photo-1511497584788-876760111969?q=80&w=1932&auto=format&fit=crop');
            --primary-color: #DA70D6;
            --container-bg: rgba(30, 0, 40, 0.85);
            --container-border: #DA70D6;
            --title-glow: #BA55D3;
            --image-glow: #DA70D6;
        }

        body {
            margin: 0;
            padding: 20px;
            font-family: 'Roboto', sans-serif;
            background-image: var(--bg-image);
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            text-align: center;
            transition: background-image 0.5s ease-in-out;
        }        /* --- Container Chính --- */
        .main-container {
            position: relative;
            background-color: var(--container-bg);
            padding: 30px 200px 15px 200px;
            border: 3px solid var(--container-border);
            box-shadow: 0 0 25px var(--container-border);
            width: 100%;
            max-width: 1000px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: background-color 0.5s, border-color 0.5s, box-shadow 0.5s;
            overflow: visible;
            clip-path: polygon(5% 0%, 95% 0%, 100% 10%, 100% 90%, 95% 100%, 5% 100%, 0% 90%, 0% 10%);
        }
        
        .main-container::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            background: linear-gradient(45deg, var(--container-border), transparent, var(--container-border));
            clip-path: polygon(5% 0%, 95% 0%, 100% 10%, 100% 90%, 95% 100%, 5% 100%, 0% 90%, 0% 10%);
            z-index: -1;
        }/* --- Hình Ảnh Nhân Vật --- */
        .character {
            position: absolute;
            bottom: 155px;
            width: 300px;
            height: 450px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: bottom center;
            pointer-events: none;
            opacity: 0.8;
        }
        .character.left {
            left: 20px;
            background-image: url('./img/nhân\ vật.png');
            filter: drop-shadow(0 0 20px var(--image-glow)) drop-shadow(0 0 40px var(--image-glow));
            transform: scale(1.5);
        }
        .character.right {
            right: 20px;
            background-image: url('./img/nhân\ vật\ 2.png');
            filter: drop-shadow(0 0 20px var(--image-glow)) drop-shadow(0 0 40px var(--image-glow));
            transform: scale(1.5);
        }
       
        /* --- Tiêu Đề --- */
        @keyframes glow {
            from {
                text-shadow: 0 0 6px rgba(255, 255, 255, 0.7), 0 0 10px var(--title-glow), 0 0 12px var(--title-glow);
            }
            to {
                text-shadow: 0 0 10px rgba(255, 255, 255, 0.9), 0 0 18px var(--title-glow), 0 0 20px var(--title-glow);
            }
        }

        .header .main-title {
            font-family: 'Anton', sans-serif;
            font-size: 5.5rem;
            color: #fff;
            margin: 0;
            line-height: 1.1;
            animation: glow 2s ease-in-out infinite alternate;
            letter-spacing: 5px;
        }

        .header .sub-title {
            font-size: 2.5rem;
            color: var(--primary-color);
            font-family: 'Anton', sans-serif;
            letter-spacing: 8px;
            margin: 10px 0 10px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
            transition: color 0.5s;
        }

        .header .price-range {
            font-size: 1.5rem;
            font-weight: 700;
            margin: 10px 0 15px;
            border: 2px solid var(--primary-color);
            padding: 5px 20px;
            border-radius: 10px;
            display: inline-block;
            background-color: rgba(0,0,0,0.4);
            transition: border-color 0.5s;
        }
        
        /* --- Nội dung chính --- */
        .content-section { width: 100%; position: relative; z-index: 2; }
        
        .maps-header {
            font-family: 'Anton', sans-serif;
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            transition: color 0.5s;
        }        .maps-grid { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-bottom: 20px; }
        .map-item { display: flex; flex-direction: column; align-items: center; gap: 10px; }
        
        .map-name-frame {
            position: relative;
            padding: 15px 25px;
            background: linear-gradient(135deg, rgba(255,255,255,0.15), rgba(255,255,255,0.05));
            border: 3px solid transparent;
            border-radius: 15px;
            backdrop-filter: blur(15px);
            box-shadow: 
                0 0 30px rgba(255, 215, 0, 0.4),
                inset 0 2px 0 rgba(255,255,255,0.3),
                inset 0 -2px 0 rgba(0,0,0,0.4),
                0 8px 32px rgba(0,0,0,0.3);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            overflow: hidden;
        }
        
        .map-name-frame::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            right: -3px;
            bottom: -3px;
            background: linear-gradient(45deg, 
                #ffd700, #ff6b6b, #4ecdc4, #45b7d1, 
                #96ceb4, #ffeaa7, #fd79a8, #ffd700);
            background-size: 400% 400%;
            border-radius: 15px;
            z-index: -1;
            animation: rainbowBorder 3s ease-in-out infinite;
        }
        
        .map-name-frame::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }
        
        .map-name-frame:hover::after {
            left: 100%;
        }
        
        @keyframes rainbowBorder {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .map-name-frame:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 
                0 0 40px rgba(255, 215, 0, 0.6),
                inset 0 2px 0 rgba(255,255,255,0.4),
                inset 0 -2px 0 rgba(0,0,0,0.4),
                0 15px 40px rgba(0,0,0,0.4);
        }
          .map-name-english {
            font-family: 'Anton', sans-serif;
            font-size: 1.4rem;
            font-weight: 900;
            margin: 0;
            letter-spacing: 3px;
            text-align: center;
            color: white;
            text-shadow: 
                0 0 20px rgba(255, 255, 255, 0.8),
                2px 2px 4px rgba(0,0,0,0.8),
                0 0 10px rgba(255, 255, 255, 0.6);
            animation: textGlow 2s ease-in-out infinite alternate;
            position: relative;
        }
        
        .map-name-english::before {
            content: attr(data-text);
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1, #ff6b6b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        .map-name-frame:hover .map-name-english::before {
            opacity: 1;
        }
          @keyframes textGlow {
            0% { 
                filter: brightness(1) drop-shadow(0 0 5px rgba(255, 255, 255, 0.5));
                transform: scale(1);
            }
            100% { 
                filter: brightness(1.2) drop-shadow(0 0 15px rgba(255, 255, 255, 0.8));
                transform: scale(1.02);
            }
        }

        .map-image-preview {
            width: 180px;
            height: 100px;
            border-radius: 8px;
            border: 2px solid var(--primary-color);
            object-fit: cover;
            background-color: #222;
            box-shadow: 0 0 8px var(--image-glow);
            transition: border-color 0.5s, box-shadow 0.5s;
        }
        .upload-btn {
            background-color: var(--primary-color);
            color: #000;
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 0.9rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            border: none;
            display: inline-block;
        }        .upload-btn:hover { filter: brightness(1.2); transform: scale(1.05); }
        .upload-wrapper input[type="file"] { display: none; }

        .crown-icon { width: 120px; margin: 25px 0; filter: drop-shadow(0 0 15px var(--primary-color)); transition: filter 0.5s, transform 0.3s; }
        .crown-icon:hover { transform: scale(1.1); }
        
        /* --- Dropdown Menu --- */
        .dropdown { position: relative; }
        .dropdown-trigger {
            background-color: var(--primary-color);
            color: #000;
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            width: 100%;
            border: none;
            text-align: center;
            transition: background-color 0.5s;
        }
        .dropdown-trigger:hover { filter: brightness(1.2); }
        .dropdown-trigger::after { content: ' ▼'; font-size: 0.8em; }
        .dropdown-options {
            display: none; position: absolute;
            background-color: rgba(10, 10, 10, 0.95);
            border: 1px solid var(--primary-color);
            border-radius: 5px; z-index: 10;
        }
        /* Style cho Dropdown giải thưởng */
        #prize-dropdown .dropdown-options { top: 100%; left: 0; right: 0; margin-top: 5px; }
        /* Style cho Dropdown chủ đề */
        #theme-dropdown .dropdown-options { bottom: 100%; left: 0; right: 0; margin-bottom: 5px; }
        
        .dropdown-options.visible { display: block; }
        .dropdown-option { padding: 10px 15px; cursor: pointer; font-weight: 700; text-align: center;}
        .dropdown-option:hover { background-color: var(--primary-color); color: #000; }
          .custom-section { width: 100%; display: flex; flex-direction: column; align-items: center; margin-top: 20px; }
        .prize-container {
             background-color: rgba(10, 10, 10, 0.7);
             padding: 25px;
             border-radius: 15px;
             width: 95%;
             max-width: 600px;
             border: 2px solid rgba(255, 255, 255, 0.3);
             box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
        }
        .prize-list { min-height: 150px; display: flex; flex-direction: column; justify-content: center; }
        .prize-item { font-size: 1.1rem; margin: 8px 0; font-weight: 700; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .trophy-icon { width: 25px; height: 25px; }
        
        /* --- Chân Trang --- */
        .footer { margin-top: 30px; position: relative; z-index: 2; }
        .social-icons { display: flex; justify-content: center; gap: 30px; margin-top: 15px; align-items: center; flex-wrap: wrap; }
        .social-item { display: flex; align-items: center; gap: 10px; }
        .social-item a { color: var(--primary-color); transition: transform 0.3s, color 0.5s; display: flex; align-items: center; }
        .social-item a:hover { transform: scale(1.15); color: #fff; }
        .social-item svg { width: 30px; height: 30px; }
        .social-item span { font-weight: 700; font-size: 1rem; color: white; }

        /* --- Nút điều khiển --- */
        .action-buttons { display: flex; gap: 15px; margin-top: 20px; }
        .action-button {
            color: white; padding: 12px 25px; border-radius: 8px;
            font-size: 1.1rem; font-weight: 700; cursor: pointer;
            transition: background-color 0.3s, transform 0.2s; border: 2px solid white;
        }
        .export-button { background-color: #008cff; }
        .export-button:hover { background-color: #00aaff; transform: scale(1.05); }
        .theme-button { background-color: #9400d3; }
        .theme-button:hover { background-color: #ab27e8; transform: scale(1.05); }        /* --- Responsive Design --- */
        @media (max-width: 1200px) {
            .main-container { 
                padding: 25px 150px 15px 150px;
                max-width: 900px;
            }
            .character { transform: scale(1.3); }
        }
        @media (max-width: 920px) {
            .character { 
                opacity: 0.5; 
                width: 200px; 
                transform: scale(1.0);
            }
            .character.left { left: 10px; }
            .character.right { right: 10px; }
            .main-container { 
                padding: 25px 100px 15px 100px;
                max-width: 700px;
            }
        }
        @media (max-width: 768px) {
            .header .main-title { font-size: 4rem; letter-spacing: 5px; }
            .header .sub-title { font-size: 1.8rem; }
            .header .price-range { font-size: 1.2rem; }
            .maps-header { font-size: 1.5rem; }
            .maps-grid { gap: 15px; }
            .map-item { width: calc(50% - 10px); }
            .map-image-preview { width: 100%; height: 90px; }
            .social-icons { flex-direction: column; gap: 15px; }
            .character { display: none; }
            .main-container { 
                padding: 30px 20px 15px 20px;
                max-width: 500px;
            }
        }
    </style>
</head>
<body class="theme-freefire">
    
    <div class="main-container" id="capture-area">
        <div class="character left"></div>
        <div class="character right"></div>

        <header class="header">
            <h1 class="main-title">CUSTOM SCRIM HD</h1>
            <h2 class="sub-title">CUS BOX</h2>
            <p class="price-range">8K - 10K - 25K VND</p>
        </header>

        <main class="content-section">
            <h2 class="maps-header">4 MAP THI ĐẤU</h2>              <div class="maps-grid">
                <div class="map-item">
                    <div class="map-name-frame">
                        <p class="map-name-english">BERMUDA</p>
                    </div>
                    <img id="map-image1" class="map-image-preview" src="/imgg/đảo quân sự.jpg" alt="">
                </div>
                <div class="map-item">
                    <div class="map-name-frame">
                        <p class="map-name-english">PURGATORY</p>
                    </div>
                    <img id="map-image2" class="map-image-preview" src="/imgg/đảo thiên đường.jpg" alt="">
                </div>
                <div class="map-item">
                    <div class="map-name-frame">
                        <p class="map-name-english">KALAHARI</p>
                    </div>
                    <img id="map-image3" class="map-image-preview" src="/imgg/sa mạc.jpg" alt="">
                </div>
                <div class="map-item">
                    <div class="map-name-frame">
                        <p class="map-name-english">NEXTERRA</p>
                    </div>
                    <img id="map-image4" class="map-image-preview" src="/imgg/đảo thế kỉ.jpg" alt="">
                </div>
            </div>

            
            
            <div class="custom-section">
                <div class="prize-container">
                    <div class="dropdown" id="prize-dropdown">
                        <button class="dropdown-trigger" id="prize-trigger">CHỌN GIẢI THƯỞNG</button>
                        <div class="dropdown-options" id="prize-options">
                            <div class="dropdown-option" data-value="8K">CUSTOM: 8K VND</div>
                            <div class="dropdown-option" data-value="10K">CUSTOM: 10K VND</div>
                            <div class="dropdown-option" data-value="15K">CUSTOM: 15K VND</div>
                        </div>
                    </div>
                    <div class="prize-list" id="prize-display-area">
                        <!-- Giải thưởng sẽ được hiển thị ở đây bằng JavaScript -->
                    </div>
                </div>
            </div>
        </main>
        
        <footer class="footer">
            <div class="social-icons">
                <div class="social-item">
                    <a href="#" aria-label="TikTok">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" fill="currentColor"><path d="M448 209.9a210.1 210.1 0 0 1 -122.8-39.3V349.4A162.6 162.6 0 1 1 185 188.3V278.2a74.6 74.6 0 1 0 52.2 71.2V0l88 0a121.2 121.2 0 0 0 122.8 122.8V209.9z"/></svg>
                    </a>
                    <span>haidangff2k4</span>
                </div>
                 <div class="social-item">
                    <a href="#" aria-label="Facebook">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" fill="currentColor"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.8 90.5 226.4 209.3 245V327.7h-63V256h63v-54.6c0-62.2 37-96.5 93.7-96.5 27.1 0 55.5 4.8 55.5 4.8v61h-31.3c-30.8 0-40.4 19.1-40.4 38.7V256h68.8l-11 71.7h-57.8V501C413.5 482.4 504 379.8 504 256z"/></svg>
                    </a>
                    <span>BLV Hải Đăng</span>
                </div>
                <div class="social-item">
                    <a href="#" aria-label="YouTube">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" fill="currentColor"><path d="M549.7 124.1c-6.3-23.7-24.8-42.3-48.3-48.6C458.8 64 288 64 288 64S117.2 64 74.6 75.5c-23.5 6.3-42 24.9-48.3 48.6-11.4 42.9-11.4 132.3-11.4 132.3s0 89.4 11.4 132.3c6.3 23.7 24.8 42.3 48.3 48.6C117.2 448 288 448 288 448s170.8 0 213.4-11.5c23.5-6.3 42-24.9 48.3-48.6 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232 346.4V165.6l144 90.4-144 90.4z"/></svg>
                    </a>
                    <span>CUSTOM SCRIM HD</span>
                </div>
            </div>
        </footer>
    </div>
    
    <div class="action-buttons">
        <button id="export-btn" class="action-button export-button">Xuất ảnh PNG</button>
        <div class="dropdown" id="theme-dropdown">
             <button id="theme-btn" class="action-button theme-button">Đổi Chủ Đề</button>
             <div class="dropdown-options" id="theme-options">
                 <div class="dropdown-option" data-theme="theme-freefire">Free Fire</div>
                 <div class="dropdown-option" data-theme="theme-ocean">Biển Cả</div>
                 <div class="dropdown-option" data-theme="theme-volcano">Núi Lửa</div>
                 <div class="dropdown-option" data-theme="theme-action">Hành Động</div>
                 <div class="dropdown-option" data-theme="theme-cyberpunk">Cyberpunk</div>
                 <div class="dropdown-option" data-theme="theme-jungle">Rừng Rậm</div>
                 <div class="dropdown-option" data-theme="theme-galaxy">Thiên Hà</div>
                 <div class="dropdown-option" data-theme="theme-desert">Sa Mạc</div>
                 <div class="dropdown-option" data-theme="theme-arctic">Bắc Cực</div>
                 <div class="dropdown-option" data-theme="theme-sakura">Sakura</div>
                 <div class="dropdown-option" data-theme="theme-urban">Đô Thị</div>
                 <div class="dropdown-option" data-theme="theme-synthwave">Synthwave</div>
                 <div class="dropdown-option" data-theme="theme-apocalyptic">Tận Thế</div>
                 <div class="dropdown-option" data-theme="theme-fantasy">Kỳ Ảo</div>
             </div>
        </div>
    </div>

    <script>
        // --- Dữ liệu giải thưởng ---
        const prizeData = {
            '8K': [
                { top: 'TOP 1', amount: '40K' },
                { top: 'TOP 2', amount: '16K' },
                { top: 'TOP 3', amount: '8K' }
            ],
            '10K': [
                { top: 'TOP 1', amount: '60K' },
                { top: 'TOP 2', amount: '20K' },
                { top: 'TOP 3', amount: '10K' }
            ],
            '15K': [
                { top: 'TOP 1', amount: '90K' },
                { top: 'TOP 2', amount: '30K' },
                { top: 'TOP 3', amount: '15K' }
            ]
        };

        // --- Lấy các phần tử DOM ---
        const prizeTrigger = document.getElementById('prize-trigger');
        const prizeOptions = document.getElementById('prize-options');
        const prizeDisplayArea = document.getElementById('prize-display-area');
        
        const themeTrigger = document.getElementById('theme-btn');
        const themeOptions = document.getElementById('theme-options');
        const bodyEl = document.body;

        // --- Hàm để cập nhật hiển thị giải thưởng ---
        function updatePrizes(key) {
            const prizes = prizeData[key];
            let html = '';
            if (prizes) {
                prizes.forEach(prize => {
                    html += `
                        <div class="prize-item">
                            <img src="https://img.icons8.com/color/48/trophy.png" alt="Cúp" class="trophy-icon">
                            ${prize.top}: ${prize.amount}
                        </div>
                    `;
                });
            }
            prizeDisplayArea.innerHTML = html;
        }

        // --- Xử lý sự kiện cho menu dropdown giải thưởng ---
        prizeTrigger.addEventListener('click', () => prizeOptions.classList.toggle('visible'));
        prizeOptions.addEventListener('click', (event) => {
            if (event.target.classList.contains('dropdown-option')) {
                const selectedValue = event.target.getAttribute('data-value');
                prizeTrigger.textContent = event.target.textContent; 
                updatePrizes(selectedValue); 
                prizeOptions.classList.remove('visible');
            }
        });

        // --- Xử lý sự kiện cho menu dropdown chủ đề ---
        themeTrigger.addEventListener('click', () => themeOptions.classList.toggle('visible'));
        themeOptions.addEventListener('click', (event) => {
             if (event.target.classList.contains('dropdown-option')) {
                const selectedTheme = event.target.getAttribute('data-theme');
                bodyEl.className = selectedTheme;
                themeOptions.classList.remove('visible');
            }
        });

        // Đóng dropdown nếu click ra ngoài
        window.addEventListener('click', function(e) {
            if (!prizeTrigger.contains(e.target) && !prizeOptions.contains(e.target)) {
                prizeOptions.classList.remove('visible');
            }
            if (!themeTrigger.contains(e.target) && !themeOptions.contains(e.target)) {
                 themeOptions.classList.remove('visible');
            }
        });

        // Hiển thị giải thưởng 8K mặc định khi tải trang
        updatePrizes('8K');
        prizeTrigger.textContent = "CUSTOM: 8K VND";


        // --- JavaScript để hiển thị ảnh xem trước khi được tải lên ---
        document.querySelectorAll('input[type="file"]').forEach(input => {
            input.addEventListener('change', function(event) {
                const imageTargetId = this.getAttribute('data-img-target');
                const imagePreviewEl = document.getElementById(imageTargetId);
                const file = event.target.files[0];
                if (file && imagePreviewEl) {
                    imagePreviewEl.src = URL.createObjectURL(file);
                }
            });
        });

        // --- JavaScript để xuất ảnh ---
        const exportBtn = document.getElementById('export-btn');
        const captureArea = document.getElementById('capture-area');

        exportBtn.addEventListener('click', () => {
            const elementsToHide = document.querySelectorAll('.upload-wrapper, .action-buttons');
            elementsToHide.forEach(el => el.style.visibility = 'hidden');

            html2canvas(captureArea, { 
                useCORS: true,
                backgroundColor: null,
                scale: 2
            }).then(canvas => {
                elementsToHide.forEach(el => el.style.visibility = 'visible');
                const link = document.createElement('a');
                link.href = canvas.toDataURL('image/png');
                link.download = 'giai-dau-scrim-hd.png';
                link.click();
            }).catch(err => {
                console.error("Lỗi khi xuất ảnh: ", err);
                elementsToHide.forEach(el => el.style.visibility = 'visible');
            });
        });
    </script>
</body>
</html>
